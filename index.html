<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>T20 WC 2026 | Pro Auction Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
    /* Professional Dark Theme Palette */
    --bg-body: #0f172a;       /* Slate 900 */
    --bg-card: #1e293b;       /* Slate 800 */
    --bg-header: rgba(15, 23, 42, 0.95);
    --primary: #6366f1;       /* Indigo 500 */
    --primary-hover: #4f46e5; /* Indigo 600 */
    --accent: #fbbf24;        /* Amber 400 (for Captains/Highlights) */
    --text-main: #f8fafc;     /* Slate 50 */
    --text-muted: #94a3b8;    /* Slate 400 */
    --border: #334155;        /* Slate 700 */
    --success: #10b981;
}

* { box-sizing: border-box; outline: none; }

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-body);
    color: var(--text-main);
    margin: 0;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
}

/* --- Header --- */
header {
    background-color: var(--bg-header);
    border-bottom: 1px solid var(--border);
    width: 100%; padding: 20px 0; text-align: center;
    position: sticky; top: 0; z-index: 100;
    backdrop-filter: blur(8px);
}

header h1 {
    margin: 0; font-size: 1.5rem; font-weight: 700; letter-spacing: -0.5px;
    background: linear-gradient(90deg, #fff, #94a3b8);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-transform: uppercase;
}

.container {
    max-width: 1000px; width: 95%; margin-top: 40px; margin-bottom: 60px;
}

/* --- Navigation Grid (Dashboard) --- */
.nav-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;
}

.nav-card {
    background: var(--bg-card);
    padding: 30px 20px;
    border-radius: 12px;
    text-align: center; cursor: pointer;
    border: 1px solid var(--border);
    transition: all 0.2s ease-in-out;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 140px;
}

.nav-card:hover {
    transform: translateY(-4px);
    border-color: var(--primary);
    box-shadow: 0 10px 25px -5px rgba(99, 102, 241, 0.3);
}

.nav-card h3 {
    margin: 0; font-size: 1.1rem; color: var(--text-main); font-weight: 600;
}

/* --- Page Layouts --- */
.page {
    display: none; 
    background: var(--bg-card); 
    padding: 40px;
    border-radius: 16px; 
    border: 1px solid var(--border);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
    animation: fadeIn 0.3s ease;
}

.page.active { display: block; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.back-btn {
    background: transparent; color: var(--text-muted); 
    border: 1px solid var(--border);
    padding: 8px 16px; border-radius: 6px;
    cursor: pointer; margin-bottom: 25px;
    font-size: 0.9rem; transition: all 0.2s;
    display: inline-flex; align-items: center;
}

.back-btn:hover { background: var(--border); color: var(--text-main); }
.back-btn::before { content: "‚Üê"; margin-right: 8px; }

h2 { margin-top: 0; border-bottom: 1px solid var(--border); padding-bottom: 15px; margin-bottom: 25px; color: var(--text-main); }

/* --- Squad Styling --- */
.group-header {
    background: linear-gradient(90deg, var(--primary), var(--primary-hover));
    color: white; padding: 12px 20px;
    margin-top: 30px; margin-bottom: 15px;
    border-radius: 8px; font-weight: 600; font-size: 0.95rem; letter-spacing: 1px;
    text-transform: uppercase;
}

.team-section { margin-bottom: 30px; }

.team-title {
    color: var(--primary); font-size: 1.1rem; font-weight: 700;
    margin-bottom: 12px; display: block;
    padding-left: 5px; border-left: 4px solid var(--primary);
}

.player-list { 
    display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); 
    gap: 10px;
}

.player-name { 
    background: rgba(255,255,255,0.03); 
    padding: 10px 12px; 
    border-radius: 6px; 
    border: 1px solid var(--border);
    font-size: 0.85rem; color: var(--text-muted);
    transition: background 0.2s;
}

.player-name:hover { background: rgba(255,255,255,0.08); color: var(--text-main); }

.captain { 
    color: var(--accent); 
    border-color: rgba(251, 191, 36, 0.3);
    background: rgba(251, 191, 36, 0.05);
    font-weight: 600;
}

/* --- Contestant Grid --- */
.contestant-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px;
}

.name-link {
    padding: 15px; background: rgba(255,255,255,0.03); 
    border-radius: 8px; border: 1px solid var(--border);
    text-align: center; cursor: pointer; color: var(--text-main); font-weight: 500;
}

.name-link:hover { background: var(--primary); border-color: var(--primary); color: white; }

/* --- Table Styling --- */
.table-wrapper {
    overflow-y: auto; max-height: 600px; 
    border: 1px solid var(--border); border-radius: 8px;
}

table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }

th { 
    background-color: #0f172a; 
    color: var(--text-muted); 
    position: sticky; top: 0; z-index: 10;
    text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.5px;
    padding: 15px; text-align: left; border-bottom: 1px solid var(--border);
}

td { 
    padding: 12px 15px; 
    border-bottom: 1px solid var(--border); 
    color: var(--text-main);
}

tr:hover td { background-color: rgba(255,255,255,0.02); }

/* --- Custom Dropdown Styles --- */
.filter-container {
    position: relative;
    display: inline-block;
}

.filter-button {
    padding: 10px 14px;
    border-radius: 6px;
    border: 2px solid var(--border);
    background: linear-gradient(135deg, rgba(79,172,254,0.1), rgba(255,255,255,0.05));
    color: var(--text-main);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 160px;
    justify-content: space-between;
}

.filter-button:hover {
    border-color: var(--accent);
    background: linear-gradient(135deg, rgba(79,172,254,0.2), rgba(255,255,255,0.08));
}

.filter-dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: var(--bg-card);
    border: 2px solid var(--border);
    border-radius: 6px;
    margin-top: 8px;
    min-width: 200px;
    max-height: 250px;
    overflow-y: auto;
    z-index: 1000;
    box-shadow: 0 10px 25px rgba(0,0,0,0.4);
}

.filter-dropdown.active {
    display: block;
}

.filter-option {
    padding: 10px 15px;
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    transition: background 0.2s;
}

.filter-option:hover {
    background: rgba(79,172,254,0.2);
}

.filter-option input[type="checkbox"] {
    cursor: pointer;
    accent-color: var(--accent);
}

.filter-option label {
    cursor: pointer;
    flex: 1;
    color: var(--text-main);
}

/* --- Table Analysis Column Styling --- */
#playerTableBody td:last-child {
    max-width: 400px;
    word-wrap: break-word;
    white-space: normal;
    line-height: 1.4;
}

/* --- Search Input --- */
#playerSearch { 
    width: 100%; padding: 12px 15px; 
    margin-bottom: 20px; 
    background: #0f172a; border: 1px solid var(--border); 
    border-radius: 8px; color: white; font-size: 0.95rem;
}
#playerSearch:focus { border-color: var(--primary); }

</style>
</head>
<body>

<!-- Video Background (Hidden Initially) -->
<video id="bgVideo" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 999; object-fit: cover; display: none;" autoplay muted playsinline loop>
    <source src="YTDown.com_YouTube_Jay-Shah-viral-meme-template-the-village_Media_R5mXGMQKEMU_001_720p.mp4" type="video/mp4">
    Your browser does not support the video tag.
</video>

<header>
    <img src="T20_WC_2026_Logo.jpg" width="80px" height="auto" margin-bottom="10px" display="block" vertical-align="middle">
    <h1>T20 WC 2026 Auction Dashboard</h1> 
</header>

<div class="container">

    <div id="home" class="page active" style="background: transparent; border: none; box-shadow: none; padding: 0;">
        <div class="nav-grid">
            <div class="nav-card" onclick="window.open('https://player-auction-ym5d.onrender.com/', '_blank')"><h3>üî® Live Auction</h3></div>
            <div class="nav-card" onclick="showPage('players')"><h3>üèè Players DB</h3></div>
            <div class="nav-card" onclick="showPage('contestants')"><h3>üï¥Ô∏è Contestants</h3></div>
            <div class="nav-card" onclick="showPage('points')"><h3>üèÜ Points System</h3></div>
            <div class="nav-card" onclick="showPage('rules')"><h3>üìú Rules</h3></div>
            <div class="nav-card" onclick="showPage('squads')"><h3>üë• Official Squads</h3></div>
            <div class="nav-card" onclick="showPage('schedule')"><h3>üìÖ Tournament Schedule</h3></div>
            <div class="nav-card" onclick="showPage('table')"><h3>üìä Standings Table</h3></div>
        </div>
    </div>

    <div id="squads" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Official Squads</h2>
        <div id="squads-container"></div>
    </div>
    <div id="contestants" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Contestants</h2>
        <div class="contestant-grid">
            <a class="name-link" href="contestant_pages/contestant.html?name=Anand" target="_blank">Anand</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Ankit" target="_blank">Ankit</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Balajee" target="_blank">Balajee</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Devesh" target="_blank">Devesh</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Gogu" target="_blank">Gogu</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Herit" target="_blank">Herit</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Maddy" target="_blank">Maddy</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Murthy" target="_blank">Murthy</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Pranav" target="_blank">Pranav</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Shenoy" target="_blank">Shenoy</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Soham" target="_blank">Soham</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Tarang" target="_blank">Tarang</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Varad" target="_blank">Varad</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Vaibhav" target="_blank">Vaibhav</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Venkat" target="_blank">Venkat</a>
            <a class="name-link" href="contestant_pages/contestant.html?name=Vinit" target="_blank">Vinit</a>
        </div>
    </div>

    <div id="players" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Players Database (300)</h2>
        <div style="margin-bottom: 20px; display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
            <div class="filter-container">
                <button class="filter-button" onclick="toggleDropdown('roleFilter')">
                    <span>üìç <span id="roleLabel">Select Role(s)</span></span>
                    <span style="font-size: 0.8rem;">‚ñº</span>
                </button>
                <div id="roleFilter" class="filter-dropdown"></div>
            </div>
            
            <div class="filter-container">
                <button class="filter-button" onclick="toggleDropdown('countryFilter')">
                    <span>üåç <span id="countryLabel">Select Country(ies)</span></span>
                    <span style="font-size: 0.8rem;">‚ñº</span>
                </button>
                <div id="countryFilter" class="filter-dropdown"></div>
            </div>

            <div class="filter-container">
                <button class="filter-button" onclick="toggleDropdown('suggestionFilter')">
                    <span>‚≠ê <span id="suggestionLabel">Select Suggestion(s)</span></span>
                    <span style="font-size: 0.8rem;">‚ñº</span>
                </button>
                <div id="suggestionFilter" class="filter-dropdown"></div>
            </div>
            
            <input type="text" id="nameFilter" placeholder="üîç Search by name..." onkeyup="applyFilters()" style="padding: 10px 12px; border-radius: 6px; border: 2px solid var(--border); background: rgba(255,255,255,0.05); color: var(--text-main); font-size: 0.9rem; flex: 1; min-width: 150px; transition: all 0.3s;">
            <button onclick="resetFilters()" style="padding: 10px 18px; border-radius: 6px; border: none; background: linear-gradient(135deg, var(--accent), rgba(251,191,36,0.8)); color: #000; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: all 0.3s; box-shadow: 0 4px 12px rgba(251,191,36,0.3);">Reset</button>
        </div>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Country</th>
                        <th>Rating</th>
                        <th>Price Target</th>
                        <th>Analysis</th>
                    </tr>
                </thead>
                <tbody id="playerTableBody">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="schedule" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Tournament Schedule - T20 WC 2026</h2>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th style="min-width: 100px;">Date</th>
                        <th>Match</th>
                        <th>Venue</th>
                        <th>Time (IST)</th>
                    </tr>
                </thead>
                <tbody id="scheduleTableBody">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="rules" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Schedule</h2>
        <div style="color: #e8e8e8; line-height: 1.6; max-width: 900px;">
            <p style="color: #ffffff;"><strong>Auction Day 1:</strong> 28th Jan 5:30pm-8:30pm PST | 8:30pm-11:30pm EST | 29th Jan 7:00am-10:00am IST</p>
            <p style="color: #ffffff;"><strong>Auction Day 2:</strong> 30th Jan 6:00pm-9:00pm PST | 9:00pm-12:00am EST | 31st Jan 7:30am-10:30am IST</p>
            <p style="color: #ffffff;"><strong>Auction Day 3:</strong> 03rd Feb 5:30pm-8:30pm PST | 8:30pm-11:30pm EST | 4th Feb 7:00am-10:00am IST</p>
        </div>
        <h2>Rules</h2>
        <div style="color: #e8e8e8; line-height: 1.6; max-width: 900px;">
            <h3 style="color: #ffffff;">Introduction</h3>
            <p>Venkat, Ankit and Gentlemen we are proud to announce our in-house production - The Great Cricket Heist. 2026 comes with a breath of freshness and that freshness is now coming into our T20 Auction. Presenting to you our own website for the Auction powered by AI. We would like you to explore this website and play around with it so that we can tend to any questions and concerns before auction day Wednesday. Do check out the Live Auction website as well as the AI-generated comments on each player delivered by Akash Chopra-esque AI called Akashvaani.</p>
            
            <h4 style="color: #ffffff;">Below are some pointers on the tabs to understand:</h4>
            <ol style="line-height: 1.8;">
                <li><strong style="color: #ffffff;">Live Auction</strong><br>
                Opens a new window with the auction website. You will need a login ID and password which will be provided to you to explore. Do not try to enter the Admin account - because you are NOT. When the bidding opens you will see a drawn player name from a certain lot. The bid amount will auto-update as the bidding goes on. You can also see bidding history going on live. If you scroll down you will see each contestant's teams with their players. You will also see your own team in the middle. When the player is to be sold you will see a Going Once..Twice..Sold! Message with a sound indicating the bid is done. One interesting feature we added is a <strong style="color: #ffffff;">Trading Window</strong> where once the window is opened, you can broadcast interests, give offers to other players. You will see transaction requests in a Trading inbox which you either Accept, Decline or Counter. Once trade is completed you will see the players and budget adjusted accordingly.</li>
                
                <li><strong style="color: #ffffff;">Players DB</strong><br>
                This opens a list of squad players with Akashvaani comments on each player. Feel free to play with the filters.</li>
                
                <li><strong style="color: #ffffff;">Official Squads</strong><br>
                Data source of Players DB displayed in a better readable format</li>
                
                <li><strong style="color: #ffffff;">Contestants</strong><br>
                This tab links Player names to their team, price bought and points earned. This page is still under construction</li>
                
                <li><strong style="color: #ffffff;">Rules and Points System</strong><br>
                Basic rules and points system for this auction</li>
                
                <li><strong style="color: #ffffff;">Tournament Schedule</strong><br>
                Tournament Schedule - still needs updating since Bangladesh matches still show up xD</li>
                
                <li><strong style="color: #ffffff;">Standings Table</strong><br>
                Table will be updated once tournament begins. This will also swallow the Contestant tabs creating hyperlinks to the names in the table itself rather than have a separate tab</li>
            </ol>

            <h3 style="color: #ffffff; margin-top: 40px;">Rules of the Auction</h3>
            
            <p><strong style="color: #ffffff;">Okay so here is the basic idea of rules for the auction. (T20WC 2026: Feb 7-Mar 8)</strong></p>

            <p><strong style="color: #ffffff;">Categories:</strong> Batsman, Bowler, All-rounder and Wicket-keeper</p>

            <p><strong style="color: #ffffff;">Pointing System:</strong> The pointing system will simply be the ones followed by _______ (TBD)</p>

            <p><strong style="color: #ffffff;">Player Pool:</strong> 20 teams with each squad including 15 players = 300 players total</p>

            <p><strong style="color: #ffffff;">Squad Composition:</strong> Each contestant can buy a maximum of 25 players. On Feb 5, each contestant must provide:
            <br><br><strong style="color: #ffffff;">6 Fixed Players:</strong>
            <ul style="margin: 10px 0 10px 30px;">
                <li>1 Batsmen</li>
                <li>2 Bowlers</li>
                <li>2 All-rounder</li>
                <li>1 Wicket-keeper</li>
            </ul>
            <strong style="color: #ffffff;">12 Floating Players:</strong> Best 5 of these will be counted at the end<br><br>
            <strong style="color: #ffffff;">Captain:</strong> Must provide a captain who will give 2x points. No Vice-Captain this time (the position is a joke!)<br><br>
            <strong style="color: #ffffff;">Scoring:</strong> Only 11 players will count towards your final score
            </p>

            <p><strong style="color: #ffffff;">Example Scenarios:</strong>
            <ul style="margin: 10px 0 10px 30px;">
                <li>If someone spends entire purse on 8 players: Must mention 6 fixed players and remaining will all be floating</li>
                <li>If someone ends up with 14 players: Must select 6 fixed players and top 5 from remaining 9 players count towards total score</li>
            </ul>
            </p>

            <p><strong style="color: #ffffff;">Budget:</strong> Everyone will have a budget of 100Cr</p>

            <p><strong style="color: #ffffff;">Draft Component:</strong> There is no draft component this time. All 300 players are available for the auction.</p>

            <p style="border-top: 1px solid #ffffff; padding-top: 20px; margin-top: 30px;"><strong style="color: #ffffff;">TRADING</strong></p>

            <p>After last time's resounding success, trading between contestants is allowed and encouraged. The trading window will open after auction day ends and close before the next auction day begins:
            <ul style="margin: 10px 0 10px 30px;">
                <li>Between Day 1 and Day 2</li>
                <li>Between Day 2 and Day 3</li>
                <li>Between Day 3 and 2 hours before the first match</li>
            </ul>
            This gives enough time for trades before the next auction day starts.</p>

            <p><strong style="color: #ffffff;">Trade Rules:</strong> All subsets of players + money for players + money trades are allowed.</p>

            <p><strong style="color: #ffffff;">Unused Money:</strong> At the end of the auction, no money will be wasted. All unused money will be converted to points using this formula: <strong>You get 25 points for every unspent 50L. Maximum points from unspent money: 1000</strong></p>

            <p><strong style="color: #ffffff;">Strategy Example:</strong> Finish your squad buying just 8 players with 7Cr remaining ‚Üí 7Cr converts to 350 points ‚Üí Start tournament with 350 points. This creates multiple strategies around buying/selling players via trading to maximize unused funds.</p>

            <p style="border-top: 1px solid #ffffff; padding-top: 20px; margin-top: 30px;"><strong style="color: #ffffff;">RIGHT TO MATCH CARD</strong></p>

            <p>As the winner of the last auction, <strong style="color: #ffffff;">Shenoy</strong> will get one "<strong style="color: #ffffff;">Right to Match</strong>" card which he can use any time during auction.</p>

            <p><strong style="color: #ffffff;">How it works:</strong> If bidding for any player is done and that player is sold to any person other than Shenoy, Shenoy can match the bid and that player will go to Shenoy instead.</p>

            <p style="color: #ffb800; font-size: 0.9em; margin-top: 20px;">*No communism this time! Any rule benefitting me will just be fodder for Murthy to spread conspiracy theories of rigging the auction.</p>

            <h3 style="color: #ffffff; margin-top: 40px;">Credits and Points of Contact</h3>
            <ul style="line-height: 2;">
                <li><strong style="color: #ffffff;">Anand Dugad</strong> - Lead Product Manager</li>
                <li><strong style="color: #ffffff;">Sanjeev Murthy</strong> - Lead Website Developer</li>
                <li><strong style="color: #ffffff;">CR Madhavan</strong> - Lead AI Research Engineer</li>
                <li><strong style="color: #ffffff;">Balajee Venkataraman</strong> - Lead Auction Website Developer</li>
            </ul>
        </div>
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
    </div>

    <div id="points" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Points System</h2>
        <p style="color: var(--text-muted); line-height: 1.6;">Content coming soon...</p>
    </div>

    <div id="table" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2>Standings Table</h2>
        <p style="color: var(--text-muted); line-height: 1.6;">Content coming soon...</p>
    </div>

    <div id="generic" class="page">
        <button class="back-btn" onclick="showPage('home')">Dashboard</button>
        <h2 id="pageTitle">Page Title</h2>
        <p id="pageContent" style="color: var(--text-muted); line-height: 1.6;">Content coming soon...</p>
    </div>

</div>

<script>
// FULL DATABASE MAPPED FROM OFFICIAL SQUADS (Unchanged Data)
let allPlayers = [];

// Load player data from JSON file
fetch('players_data_central.json')
    .then(response => {
        if (!response.ok) throw new Error('Failed to load players_data_central.json');
        return response.json();
    })
    .then(data => {
        allPlayers = data;
        console.log('‚úÖ Loaded ' + allPlayers.length + ' players from players_data_central.json');
        // Populate the table after data is loaded
        populateTable();
    })
    .catch(error => {
        console.error('‚ùå Error loading player data:', error);
        allPlayers = [];
    });

// OFFICIAL ICC T20 WORLD CUP 2026 SCHEDULE (Unchanged Data)
const tournamentSchedule = [
    { date: "Feb 7, Sat", match: "Pakistan vs Netherlands", venue: "Colombo (SSC)", time: "11:00 AM" },
    { date: "Feb 7, Sat", match: "West Indies vs Bangladesh", venue: "Kolkata", time: "3:00 PM" },
    { date: "Feb 7, Sat", match: "India vs USA", venue: "Mumbai", time: "7:00 PM" },
    { date: "Feb 8, Sun", match: "New Zealand vs Afghanistan", venue: "Chennai", time: "11:00 AM" },
    { date: "Feb 8, Sun", match: "England vs Nepal", venue: "Mumbai", time: "3:00 PM" },
    { date: "Feb 8, Sun", match: "Sri Lanka vs Ireland", venue: "Colombo (RPS)", time: "7:00 PM" },
    { date: "Feb 9, Mon", match: "Bangladesh vs Italy", venue: "Kolkata", time: "11:00 AM" },
    { date: "Feb 9, Mon", match: "Zimbabwe vs Oman", venue: "Colombo (SSC)", time: "3:00 PM" },
    { date: "Feb 9, Mon", match: "South Africa vs Canada", venue: "Ahmedabad", time: "7:00 PM" },
    { date: "Feb 10, Tue", match: "Netherlands vs Namibia", venue: "Delhi", time: "11:00 AM" },
    { date: "Feb 10, Tue", match: "New Zealand vs UAE", venue: "Chennai", time: "3:00 PM" },
    { date: "Feb 10, Tue", match: "Pakistan vs USA", venue: "Colombo (SSC)", time: "7:00 PM" },
    { date: "Feb 11, Wed", match: "South Africa vs Afghanistan", venue: "Ahmedabad", time: "11:00 AM" },
    { date: "Feb 11, Wed", match: "Australia vs Ireland", venue: "Colombo (RPS)", time: "3:00 PM" },
    { date: "Feb 11, Wed", match: "England vs West Indies", venue: "Mumbai", time: "7:00 PM" },
    { date: "Feb 12, Thu", match: "Sri Lanka vs Oman", venue: "Kandy", time: "11:00 AM" },
    { date: "Feb 12, Thu", match: "Nepal vs Italy", venue: "Mumbai", time: "3:00 PM" },
    { date: "Feb 12, Thu", match: "India vs Namibia", venue: "Delhi", time: "7:00 PM" },
    { date: "Feb 13, Fri", match: "Australia vs Zimbabwe", venue: "Colombo (RPS)", time: "11:00 AM" },
    { date: "Feb 13, Fri", match: "Canada vs UAE", venue: "Delhi", time: "3:00 PM" },
    { date: "Feb 13, Fri", match: "USA vs Netherlands", venue: "Chennai", time: "7:00 PM" },
    { date: "Feb 14, Sat", match: "Ireland vs Oman", venue: "Colombo (SSC)", time: "11:00 AM" },
    { date: "Feb 14, Sat", match: "England vs Bangladesh", venue: "Kolkata", time: "3:00 PM" },
    { date: "Feb 14, Sat", match: "New Zealand vs South Africa", venue: "Ahmedabad", time: "7:00 PM" },
    { date: "Feb 15, Sun", match: "West Indies vs Nepal", venue: "Mumbai", time: "11:00 AM" },
    { date: "Feb 15, Sun", match: "USA vs Namibia", venue: "Chennai", time: "3:00 PM" },
    { date: "Feb 15, Sun", match: "India vs Pakistan", venue: "Colombo (RPS)", time: "7:00 PM" },
    { date: "Feb 16, Mon", match: "Afghanistan vs UAE", venue: "Delhi", time: "11:00 AM" },
    { date: "Feb 16, Mon", match: "England vs Italy", venue: "Kolkata", time: "3:00 PM" },
    { date: "Feb 16, Mon", match: "Australia vs Sri Lanka", venue: "Kandy", time: "7:00 PM" },
    { date: "Feb 17, Tue", match: "New Zealand vs Canada", venue: "Chennai", time: "11:00 AM" },
    { date: "Feb 17, Tue", match: "Ireland vs Zimbabwe", venue: "Kandy", time: "3:00 PM" },
    { date: "Feb 17, Tue", match: "Bangladesh vs Nepal", venue: "Mumbai", time: "7:00 PM" },
    { date: "Feb 18, Wed", match: "South Africa vs UAE", venue: "Delhi", time: "11:00 AM" },
    { date: "Feb 18, Wed", match: "Pakistan vs Namibia", venue: "Colombo (SSC)", time: "3:00 PM" },
    { date: "Feb 18, Wed", match: "India vs Netherlands", venue: "Ahmedabad", time: "7:00 PM" },
    { date: "Feb 19, Thu", match: "West Indies vs Italy", venue: "Kolkata", time: "11:00 AM" },
    { date: "Feb 19, Thu", match: "Sri Lanka vs Zimbabwe", venue: "Colombo (RPS)", time: "3:00 PM" },
    { date: "Feb 19, Thu", match: "Afghanistan vs Canada", venue: "Chennai", time: "7:00 PM" },
    { date: "Feb 20, Fri", match: "Australia vs Oman", venue: "Kandy", time: "7:00 PM" },
    { date: "Feb 21-Mar 1", match: "Super 8 Stage", venue: "Multiple Venues", time: "Various" },
    { date: "Mar 4, Wed", match: "Semi-Final 1", venue: "Kolkata/Colombo", time: "7:00 PM" },
    { date: "Mar 5, Thu", match: "Semi-Final 2", venue: "Mumbai", time: "7:00 PM" },
    { date: "Mar 8, Sun", match: "Final", venue: "Ahmedabad/Colombo", time: "7:00 PM" }
];

function showPage(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));

    // Updated Logic
    const validPages = ['home', 'rules', 'squads', 'points', 'contestants', 'table', 'trade', 'players', 'schedule'];
    
    if (validPages.includes(pageId)) {
        if(pageId === 'players') populateTable();
        if(pageId === 'schedule') populateSchedule();
        document.getElementById(pageId).classList.add('active');
    } else {
        const generic = document.getElementById('generic');
        document.getElementById('pageTitle').innerText = pageId.toUpperCase();
        document.getElementById('pageContent').innerText = "This page will show the " + pageId + " information as described in your notes.";
        generic.classList.add('active');
    }
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function normalizeRole(role) {
    // Remove (C), (vc), and other captain/vice-captain indicators
    return role.replace(/\s*\([A-Za-z]*\)\s*/g, '').trim();
}

function toggleDropdown(dropdownId) {
    const dropdown = document.getElementById(dropdownId);
    dropdown.classList.toggle('active');
    // Close other dropdowns
    document.querySelectorAll('.filter-dropdown').forEach(d => {
        if(d.id !== dropdownId) d.classList.remove('active');
    });
}

function closeDropdowns() {
    document.querySelectorAll('.filter-dropdown').forEach(d => d.classList.remove('active'));
}

let playerSuggestions = {};
let suggestionsLoaded = false;

// Load suggestions from JSON
const suggestionsPromise = fetch('player_suggestions.json')
    .then(r => {
        if (!r.ok) throw new Error('Failed to load player_suggestions.json');
        return r.json();
    })
    .then(data => {
        playerSuggestions = data;
        suggestionsLoaded = true;
        console.log('‚úÖ Loaded player suggestions for ' + Object.keys(data).length + ' players');
        return data;
    })
    .catch(err => {
        console.error('‚ùå Could not load player_suggestions.json:', err);
        suggestionsLoaded = true;
        return {};
    });

function initializeFilters() {
    // Extract unique roles, countries, and ratings from allPlayers
    const roles = [...new Set(allPlayers.map(p => normalizeRole(p.role)))].sort();
    const countries = [...new Set(allPlayers.map(p => p.country))].sort();
    const ratings = [...new Set(allPlayers.map(p => p.rating).filter(r => r))].sort();
    
    // Populate role dropdown
    const roleFilter = document.getElementById('roleFilter');
    roles.forEach(role => {
        const option = document.createElement('div');
        option.className = 'filter-option';
        option.innerHTML = `
            <input type="checkbox" id="role_${role}" value="${role}" onchange="applyFilters();updateLabel('role')">
            <label for="role_${role}">${role}</label>
        `;
        roleFilter.appendChild(option);
    });
    
    // Populate country dropdown
    const countryFilter = document.getElementById('countryFilter');
    countries.forEach(country => {
        const option = document.createElement('div');
        option.className = 'filter-option';
        option.innerHTML = `
            <input type="checkbox" id="country_${country}" value="${country}" onchange="applyFilters();updateLabel('country')">
            <label for="country_${country}">${country}</label>
        `;
        countryFilter.appendChild(option);
    });

    // Populate rating dropdown
    const ratingFilter = document.getElementById('suggestionFilter');
    ratings.forEach(rating => {
        const option = document.createElement('div');
        option.className = 'filter-option';
        const displayRating = rating.substring(0, 50) + (rating.length > 50 ? '...' : '');
        option.innerHTML = `
            <input type="checkbox" id="rating_${ratings.indexOf(rating)}" value="${rating}" onchange="applyFilters();updateLabel('rating')">
            <label for="rating_${ratings.indexOf(rating)}">${displayRating}</label>
        `;
        ratingFilter.appendChild(option);
    });
}

function updateLabel(filterType) {
    if(filterType === 'role') {
        const selected = document.querySelectorAll('#roleFilter input:checked').length;
        document.getElementById('roleLabel').textContent = selected > 0 ? `${selected} role(s)` : 'Select Role(s)';
    } else if(filterType === 'country') {
        const selected = document.querySelectorAll('#countryFilter input:checked').length;
        document.getElementById('countryLabel').textContent = selected > 0 ? `${selected} country(ies)` : 'Select Country(ies)';
    } else if(filterType === 'rating') {
        const selected = document.querySelectorAll('#suggestionFilter input:checked').length;
        document.getElementById('suggestionLabel').textContent = selected > 0 ? `${selected} rating(s)` : 'Select Rating(s)';
    }
}

// Dynamically extract Cricinfo links from Official Squads
function buildCricinfURLMap() {
    const urlMap = {};
    const squadsSection = document.getElementById('squads');
    if (squadsSection) {
        // Find all links in the squads section
        const links = squadsSection.querySelectorAll('a[href*="espncricinfo.com/cricketers"]');
        links.forEach(link => {
            // Get player name by removing (C) and (vc) suffixes
            let playerName = link.textContent.trim();
            playerName = playerName.replace(/\s*\([A-Za-z]*\)\s*/g, '').trim();
            const url = link.href;
            urlMap[playerName] = url;
        });
    }
    return urlMap;
}

// Build the map when page loads
let cricinfURLs = {};
document.addEventListener('DOMContentLoaded', function() {
    cricinfURLs = buildCricinfURLMap();
    console.log('‚úÖ Loaded Cricinfo URLs for ' + Object.keys(cricinfURLs).length + ' players');
});

function populateTable() {
    const tbody = document.getElementById('playerTableBody');
    
    // Wait for suggestions to load, then populate
    suggestionsPromise.then(() => {
        const formatPrice = (value) => {
            if (value === undefined || value === null || value === '') return '‚Äî';
            const raw = String(value).replace(/‚Çπ/g, '').replace(/\bCr\b/gi, '').trim();
            if (raw === '') return '‚Äî';
            return `‚Çπ${raw} Cr`;
        };
        const rows = allPlayers.map(p => {
            const suggestion = playerSuggestions[p.name] || {};
            // Get Cricinfo URL from mapping, or use fallback
            const cricinfUrl = cricinfURLs[p.name] || `https://www.espncricinfo.com/cricketers/${p.name.toLowerCase().replace(/\s+/g, '-')}`;
            const playerLink = `<a href="${cricinfUrl}" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;" onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color='var(--primary)'">${p.name}</a>`;
            
            // Use rating and price from player-information if available, otherwise from suggestions
            const displayRating = p.rating || suggestion.suggestion || '‚Äî';
            const displayPrice = p.priceTarget
                ? formatPrice(p.priceTarget)
                : (suggestion.price_target ? formatPrice(suggestion.price_target.toFixed(1)) : '‚Äî');
            const displayAnalysis = p.analysis || suggestion.analysis || '‚Äî';
            
            return `<tr><td>${playerLink}</td><td>${p.role}</td><td>${p.country}</td><td>${displayRating}</td><td>${displayPrice}</td><td>${displayAnalysis}</td></tr>`;
        });
        
        tbody.innerHTML = rows.join('');
        
        // Initialize filters after populating table
        if (document.getElementById('roleFilter').children.length === 0) {
            initializeFilters();
        }
    });
}

function populateSchedule() {
    const tbody = document.getElementById('scheduleTableBody');
    tbody.innerHTML = tournamentSchedule.map(s => `<tr><td>${s.date}</td><td>${s.match}</td><td>${s.venue}</td><td>${s.time}</td></tr>`).join('');
}

function applyFilters() {
    const selectedRoles = Array.from(document.querySelectorAll('#roleFilter input:checked')).map(o => o.value);
    const selectedCountries = Array.from(document.querySelectorAll('#countryFilter input:checked')).map(o => o.value);
    const selectedRatings = Array.from(document.querySelectorAll('#suggestionFilter input:checked')).map(o => o.value);
    const nameInput = document.getElementById('nameFilter').value.toLowerCase();
    
    const rows = document.querySelectorAll('#playerTableBody tr');
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const name = cells[0].textContent.toLowerCase();
        const role = normalizeRole(cells[1].textContent);
        const country = cells[2].textContent;
        const rating = cells[3].textContent.trim();
        
        const matchesRole = selectedRoles.length === 0 || selectedRoles.includes(role);
        const matchesCountry = selectedCountries.length === 0 || selectedCountries.includes(country);
        const matchesRating = selectedRatings.length === 0 || selectedRatings.includes(rating);
        const matchesName = nameInput === '' || name.includes(nameInput);
        
        row.style.display = (matchesRole && matchesCountry && matchesRating && matchesName) ? '' : 'none';
    });
}

function resetFilters() {
    document.querySelectorAll('#roleFilter input:checked').forEach(cb => cb.checked = false);
    document.querySelectorAll('#countryFilter input:checked').forEach(cb => cb.checked = false);
    document.querySelectorAll('#suggestionFilter input:checked').forEach(cb => cb.checked = false);
    document.getElementById('nameFilter').value = '';
    document.getElementById('roleLabel').textContent = 'Select Role(s)';
    document.getElementById('countryLabel').textContent = 'Select Country(ies)';
    document.getElementById('suggestionLabel').textContent = 'Select Rating(s)';
    applyFilters();
}

// Initialize click counter and video visibility flag
let clickCount = 0;
let videoPlaying = false;

// Single click handler for both dropdowns and video background
document.addEventListener('click', function(event) {
    // Close dropdowns when clicking outside filter containers
    if (!event.target.closest('.filter-container') && !event.target.closest('.filter-button')) {
        closeDropdowns();
    }
    
    clickCount++;
    
    // Show video on 10th click
    if (clickCount === 10) {
        const bgVideo = document.getElementById('bgVideo');
        if (bgVideo) {
            bgVideo.style.display = 'block';
            bgVideo.play();
            videoPlaying = true;
        }
    }
    
    // Hide video on 11th click
    if (clickCount === 11) {
        const bgVideo = document.getElementById('bgVideo');
        if (bgVideo) {
            bgVideo.style.display = 'none';
            bgVideo.pause();
            videoPlaying = false;
        }
    }
});

// Load and render squads from JSON
async function loadAndRenderSquads() {
    try {
        const response = await fetch('players_data_central.json');
        const players = await response.json();
        
        // Group players by squad (GROUP A, B, C)
        const squadGroups = {};
        players.forEach(player => {
            if (!squadGroups[player.squad]) {
                squadGroups[player.squad] = {};
            }
            if (!squadGroups[player.squad][player.country]) {
                squadGroups[player.squad][player.country] = [];
            }
            squadGroups[player.squad][player.country].push(player);
        });
        
        const container = document.getElementById('squads-container');
        container.innerHTML = '';
        
        // Define group order
        const groupOrder = ['GROUP A', 'GROUP B', 'GROUP C'];
        
        groupOrder.forEach(groupName => {
            if (!squadGroups[groupName]) return;
            
            // Add group header
            const groupHeader = document.createElement('div');
            groupHeader.className = 'group-header';
            groupHeader.textContent = groupName;
            container.appendChild(groupHeader);
            
            // Sort countries alphabetically
            const countries = Object.keys(squadGroups[groupName]).sort();
            
            countries.forEach(country => {
                const teamSection = document.createElement('div');
                teamSection.className = 'team-section';
                
                // Country header with flag
                const teamTitle = document.createElement('span');
                teamTitle.className = 'team-title';
                
                const flagImg = document.createElement('img');
                flagImg.src = `https://flagcdn.com/w40/${squadGroups[groupName][country][0].flagCode}.png`;
                flagImg.alt = `${country} Flag`;
                flagImg.style.marginRight = '10px';
                
                const countryText = document.createElement('span');
                countryText.textContent = country;
                
                teamTitle.appendChild(flagImg);
                teamTitle.appendChild(countryText);
                teamSection.appendChild(teamTitle);
                
                // Player list
                const playerList = document.createElement('div');
                playerList.className = 'player-list';
                
                squadGroups[groupName][country].forEach(player => {
                    const playerLink = document.createElement('a');
                    playerLink.href = player.espncricinfo;
                    playerLink.target = '_blank';
                    playerLink.className = 'player-name';
                    
                    // Check if player is captain (has "(C)" in role)
                    if (player.role.includes('(C)')) {
                        playerLink.classList.add('captain');
                    }
                    
                    playerLink.textContent = player.name;
                    playerList.appendChild(playerLink);
                });
                
                teamSection.appendChild(playerList);
                container.appendChild(teamSection);
            });
        });
    } catch (error) {
        console.error('Error loading squads:', error);
    }
}

// Load both squads and contestants when page loads
document.addEventListener('DOMContentLoaded', () => {
    loadAndRenderSquads();
});

</script>

</body>
</html>
